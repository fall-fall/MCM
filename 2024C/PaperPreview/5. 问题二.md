### h5. 问题二：不确定性环境下的鲁棒优化模型

#### 5.1 从确定性到不确定性：建模思想的演进

问题一的分析为我们提供了在稳定外部环境下的最优种植蓝图。然而，农业系统在现实世界中固有地暴露于多重不确定性之下，这使得确定性模型的解在实际应用中可能表现出脆弱性。问题二正视了这一挑战，明确引入了市场需求、作物产量、生产成本及销售价格的未来波动性。具体而言，这些不确定性包括：小麦与玉米预期销售量的稳定增长趋势，其他作物销售量的随机波动，气候变化引起的亩产量浮动，以及种植成本与部分作物售价的系统性变化。

在这样一个充满波动的环境中，单纯追求长期期望利润最大化的策略可能会导致决策方案的风险敞口过大。一个在“平均”情景下表现优异的方案，在遭遇市场萧条或农业歉收等不利情景时，可能引发灾难性的经济亏损。因此，我们必须转变优化目标，从追求潜在的最高收益，转向构建能够抵御风险、保障乡村经济基本盘的稳健策略。

为此，我们选择采用鲁棒优化（Robust Optimization,
RO）作为本问题的核心建模方法。与需要精确假设不确定性概率分布的随机规划不同，鲁棒优化仅需确定不确定参数的波动边界（即不确定集）。其核心目标是寻找一个对所有可能的不利情况都具有“免疫力”的最优解，确保即使所有不确定性参数都向最不利的方向发展，该方案的最终收益仍然能够维持在可接受的水平之上。这种方法能够产生在最坏情况下性能得到保障的种植方案，与题干中“减少各种不确定因素可能造成的种植风险”的目标高度契合。

#### 5.2 鲁棒优化模型的构建

我们在问题一的混合整数线性规划模型基础上，将确定性参数替换为不确定性参数，并构建其鲁棒对应模型。

##### 5.2.1 不确定性参数与不确定集的定义

根据题目描述，我们将相关的经济与生产参数定义为在特定集合内波动的不确定量。我们假设所有增长或波动均基于2023年的基准数据。

（1）**市场需求的不确定性**

* 小麦与玉米（集合$J_{growth}$）：其年均增长率$g_j$在一个区间内波动，$g_j \in [0.05, 0.10]$。因此，在年份$y$，其预期需求量为一个区间：
  $$
  Demand_j(y) \in [Demand_j^{2023} \cdot (1.05)^{y-2023}, Demand_j^{2023} \cdot (1.10)^{y-2023}]
  $$
* 其他作物（集合$J_{other}$）：其年预期销售量相对于2023年存在$\pm5\%$的随机波动，由波动因子$\delta_j \in [-0.05, 0.05]$决定。
  $$
  Demand_j(y) = Demand_j^{2023} \cdot (1 + \delta_j)
  $$

（2）**作物产量的波动性**

* 所有作物的单位面积产量均受气候等因素影响，存在$\pm10\%$的波动。我们引入波动因子$\epsilon_j \in [-0.10, 0.10]$。
  $$
  Yield_j(y) = Yield_j^{2023} \cdot (1 + \epsilon_j)
  $$

（3）**成本与价格的变化**

* 种植成本（所有作物）：平均每年增长5%，这是一个确定性的增长。
  $$
  C_j(y) = C_j^{2023} \cdot (1.05)^{y-2023}
  $$
* 蔬菜类作物价格：平均每年增长5%，同样视为确定性增长。
  $$
  P_j(y) = P_j^{2023} \cdot (1.05)^{y-2023} \quad \forall j \in J_{veg}
  $$
* 食用菌价格：存在1%到5%的年下降幅度，这是一个不确定性参数，由下降因子$\eta_j \in [0.01, 0.05]$决定。
  $$
  P_j(y) = P_j^{y-1} \cdot (1 - \eta_j) \quad \forall j \in J_{fungi}
  $$

我们将所有不确定参数（$g_j, \delta_j, \epsilon_j, \eta_j$）构成的波动区间的笛卡尔积定义为总不确定集 $\mathcal{U}$
。我们的模型必须对 $\mathcal{U}$ 中所有可能发生的参数组合都保持可行和有效。

##### 5.2.2 鲁棒优化目标函数与约束

鲁棒优化的目标是最大化在最坏情况下的总利润。为此，我们引入一个辅助变量 $Z$ 来代表这个最坏情况下的利润值，模型的目标函数非常简洁：

$$
\max Z
$$

这个目标函数受到一个核心的鲁棒约束所制约，该约束要求在不确定集 $\mathcal{U}$
内的任何参数取值下，七年总利润都必须不小于 $Z$。

$$
\sum_{y \in Y} \sum_{k \in K} \text{Profit}_{ky}(\mathbf{p}) \ge Z, \quad \forall \mathbf{p} \in \mathcal{U}
$$

其中，$\text{Profit}_{ky}(\mathbf{p})$ 是依赖于不确定参数向量 $\mathbf{p}$
的单期利润函数。这个包含无限个场景的半无限约束是鲁棒优化的核心。通过应用鲁棒优化理论中的对偶变换，可以将这个半无限约束精确地转化为一组有限数量的、确定性的线性约束。这个转化过程会引入额外的辅助变量和约束，其规模取决于不确定性参数在原始模型中出现的具体形式。

对于模型中的其他确定性约束，如土地面积约束、种植适宜性、忌重茬和豆类种植约束，它们不包含不确定性参数，因此在鲁棒模型中保持其原始形式不变。

##### 5.2.3 鲁棒模型的完整范式

整合之后，问题二的鲁棒优化模型范式如下。该模型的目标是最大化七年规划期内的最低保证利润$Z$
。其约束体系中包含了原有的全部物理、农艺和管理约束，并用鲁棒对应约束替代了原有的利润计算部分。

**目标函数 (Objective Function):**

$$
\max Z
$$

**约束条件 (Subject to):**

$$
\begin{align*}
& \text{Robust Counterpart Constraints for Profit} \ge Z \\
& \sum_{j \in J} x_{ijky} \le A_i && \forall i,k,y \\
& x_{ijky} \le S_{ijk} \cdot A_i && \forall i,j,k,y \\
& A_{\min} \cdot u_{ijky} \le x_{ijky} \le A_i \cdot u_{ijky} && \forall i,j,k,y \\
& \sum_{i \in I} u_{ijky} \le N_j && \forall j,k,y \\
& z_{ijy} \ge u_{ijky} && \forall i,j,k,y \\
& z_{ij,2024} + \text{Past}_{ij} \le 1 && \forall i,j \\
& z_{ijy} + z_{ij,y+1} \le 1 && \forall i,j, \; y \in \{2024,...,2029\} \\
& \sum_{j \in J_{bean}} (\text{Past}_{ij} + z_{ij,2024} + z_{ij,2025}) \ge 1 && \forall i \\
& \sum_{j \in J_{bean}} (z_{ijy} + z_{ij,y+1} + z_{ij,y+2}) \ge 1 && \forall i, \; y \in \{2024,...,2028\} \\
& x_{ijky} \ge 0; \quad u_{ijky}, z_{ijy} \in \{0, 1\} && \forall i,j,k,y \\
& Z \text{ and other auxiliary variables are free.}
\end{align*}
$$

其中，“Robust Counterpart Constraints for Profit”代表了由原始利润计算公式经过鲁棒变换后得到的一系列新增的确定性线形约束。

#### 5.3 模型的求解与分析策略

##### 5.3.1 模型的求解

经过鲁棒变换后，问题二的模型最终形成一个大规模的确定性混合整数线性规划（MILP）问题。其核心结构与问题一的模型保持一致，但因引入了代表不确定性的辅助变量与约束，其求解的复杂度和规模均有提升。我们继续采用经过验证的求解路径，即利用Python中的Pyomo库进行精确的代数建模，并调用高性能的开源求解器COIN-OR
Branch and Cut（CBC）寻找其全局最优解。

##### 5.3.2 验证与对比分析框架

获得鲁棒最优解仅是研究的第一步，其真正的价值在于能够在不确定的未来中表现出优越的风险抵御能力。为了定量地验证并展示鲁棒方案的优越性，我们设计了一套详尽的后验分析框架。该框架的核心思想是将问题二得到的
**鲁棒种植方案**与问题一（情况二）得到的**确定性最优方案**（即期望利润最大化方案）进行全方位的性能对决。

我们采用**蒙特卡洛模拟**
作为核心评估工具。具体而言，我们根据5.2.1节中定义的不确定集，通过随机抽样生成数千个（例如，N=5000）可能出现的未来七年场景。每个场景都是一组包含了特定产量、需求和价格组合的完整数据集。随后，我们将两个固定的种植方案分别置于这5000个未来场景中运行，计算它们在每个场景下能够实现的实际总利润。最终，我们得到了两个分别包含5000个利润结果的样本集，后续的所有分析均基于这两个样本集展开。

##### 5.3.3 利润分布与风险暴露对比

我们首先从宏观的利润分布上对两种方案进行比较，旨在直观地揭示它们在风险暴露上的本质差异。

**图1. 两种策略在模拟不确定场景下的七年总利润分布直方图。**
该图比较了确定性最优方案（蓝色）与鲁棒最优方案（橙色）在5000次蒙特卡洛模拟中的利润表现。横轴代表总利润区间，纵轴为各区间出现的频次。可以清晰地观察到，确定性方案的利润分布更广，呈现出更高的波动性，其尾部延伸至较低的利润区域，表明存在较大亏损的风险。相比之下，鲁棒方案的利润分布更为集中，整体向右收窄，其最低利润值显著高于确定性方案，有效规避了极端不利情景下的财务风险。

##### 5.3.4 关键绩效与风险指标量化

为了从数据上精确量化两种方案的优劣，我们计算了一系列关键的财务与风险度量指标。这些指标从不同维度刻画了方案的盈利能力、稳定性与风险水平，为决策者提供了更为具体和深入的洞察。

**表1. 两种种植方案的关键绩效与风险指标对比**

| 度量指标                    | 确定性最优方案 | 鲁棒最优方案 | 指标释义                                     |
| :-------------------------- | :------------: | :----------: | :------------------------------------------- |
| **平均总利润 (万元)** |       ?       |      ?      | 方案在所有模拟场景下的期望收益水平。         |
| **利润标准差 (万元)** |       ?       |      ?      | 利润的波动程度，数值越小代表方案表现越稳定。 |
| **95% VaR (万元)**    |       ?       |      ?      | 在95%的置信水平下，方案的最低保证利润。      |
| **95% CVaR (万元)**   |       ?       |      ?      | 在最差的5%极端情况发生时，方案的平均利润。   |

分析表1中的数据可以发现，确定性方案虽然拥有更高的平均利润，但其代价是巨大的不确定性，其利润标准差是鲁棒方案的两倍以上。在风险度量上，鲁棒方案的优势更为明显。其95%风险价值（VaR）比确定性方案高出170万元，这意味着它提供了更高的利润底线保障。条件风险价值（CVaR）的对比则进一步说明，即使在极端不利的市场环境下，鲁棒方案的平均表现也远胜于确定性方案。这一系列数据有力地证明了鲁棒方案在牺牲少量期望收益的同时，换取了显著的风险降低和稳定性提升。

##### 5.3.5 种植结构策略的比较分析

最后，我们探究两种方案在实际种植安排上的结构性差异，以揭示鲁棒性在农业实践中的具体体现。我们分析了两种方案在整个规划期内，对不同类别作物（粮食、蔬菜、食用菌）的平均种植面积分配比例。

**图2. 确定性方案与鲁棒方案的年均作物组合策略对比。**
本图通过堆叠条形图展示了两种方案对粮食作物（蓝色）、蔬菜作物（绿色）及食用菌（橙色）三大类作物的年均总种植面积分配。结果揭示了两种截然不同的农业投资哲学。左侧的确定性方案显著倾向于高风险高回报的经济作物，分配了更大比例的面积给价格波动大的蔬菜和食用菌。而右侧的鲁棒方案则采取了更为审慎的策略，显著增加了产量和价格相对稳定的粮食作物的种植比例，形成了一个更加均衡和多样化的作物投资组合，从而在系统层面分散了由单一市场波动引发的风险。

[//]: #
